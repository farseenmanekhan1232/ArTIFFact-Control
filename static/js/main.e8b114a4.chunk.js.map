{"version":3,"sources":["assets/images/logo.jpg","store/actions/index.js","store/actions/video.js","containers/SideBar/SideBarItem/SideBarItem.js","containers/SideBar/SideBarHeader/SideBarHeader.js","containers/SideBar/Subscriptions/Subscription/Subscription.js","containers/SideBar/Subscriptions/Subscriptions.js","containers/SideBar/SideBarFooter/SideBarFooter.js","containers/SideBar/SideBar.js","components/VideoGrid/VideoGridHeader/VideoGridHeader.js","services/number/number-format.js","services/date/date-format.js","components/VideoPreview/VideoPreview.js","components/VideoGrid/VideoGrid.js","store/actions/watch.js","services/url/index.js","store/reducers/videos.js","store/api/youtube-api-response-types.js","components/InfiniteScroll/InfiniteScroll.js","containers/Home/HomeContent/HomeContent.js","store/actions/api.js","store/reducers/api.js","containers/Home/Home.js","containers/HeaderNav/HeaderNav.js","components/ScrollToTop/ScrollToTop.js","components/AppLayout/AppLayout.js","components/Video/Video.js","components/Rating/Rating.js","components/VideoMetadata/VideoMetadata.js","components/VideoInfoBox/VideoInfoBox.js","containers/Comments/CommentsHeader/CommentsHeader.js","containers/Comments/Comment/Comment.js","containers/Comments/AddComment/AddComment.js","containers/Comments/Comments.js","components/RelatedVideos/NextUpVideo/NextUpVideo.js","components/RelatedVideos/RelatedVideos.js","store/reducers/channels.js","store/actions/comment.js","store/reducers/comments.js","containers/Watch/WatchContent/WatchContent.js","containers/Watch/Watch.js","components/VideoList/VideoList.js","containers/Trending/Trending.js","store/actions/search.js","store/reducers/search.js","containers/Search/Search.js","App.js","registerServiceWorker.js","store/reducers/index.js","store/api/youtube-api.js","store/sagas/video.js","store/sagas/watch.js","store/sagas/comment.js","store/sagas/search.js","store/sagas/index.js","index.js","store/configureStore.js"],"names":["module","exports","REQUEST","SUCCESS","FAILURE","createRequestTypes","base","Error","reduce","acc","type","createAction","payload","VIDEO_CATEGORIES","categories","request","success","response","failure","MOST_POPULAR","mostPopular","amount","loadDescription","nextPageToken","MOST_POPULAR_BY_CATEGORY","mostPopularByCategory","SideBarItem","highlight","this","shouldBeHighlighted","to","pathname","props","path","Menu","Item","className","join","Icon","size","name","icon","label","location","includes","React","Component","withRouter","SideBarHeader","heading","title","toUpperCase","Header","Subscription","rightElement","broadcasting","amountNewVideos","Image","src","avatar","Subscriptions","Fragment","Divider","SideBarFooter","SideBar","borderless","vertical","stackable","fixed","VideoGridHeader","UNITS","getShortNumberString","number","digits","some","element","index","lowerBound","Math","pow","i","length","decimal","toFixed","toString","objMap","numbers","datePattern","timePattern","pattern","RegExp","getVideoDurationString","iso8601DurationString","match","slice","prev","next","idx","parseFloat","days","hours","minutes","seconds","secondsString","minutesString","accumulatedHours","padStart","TimeAgo","locale","en","timeAgo","VideoPreview","video","videoDuration","contentDetails","duration","viewAndTimeString","getFormattedViewAndTime","horizontal","expanded","description","snippet","search","thumbnails","medium","url","channelTitle","publicationDate","Date","publishedAt","statistics","viewCount","viewCountShort","format","VideoGrid","videos","gridItems","map","key","id","divider","hideDivider","WATCH_DETAILS","details","videoId","channelId","VIDEO_DETAILS","videoDetails","getSearchParam","URLSearchParams","get","initialState","byId","byCategory","related","reduceFetchMostPopularVideos","prevState","videoMap","items","accumulator","Object","keys","hasOwnProperty","totalResults","pageInfo","reduceFetchVideoCategories","categoryMapping","category","reduceFetchMostPopularVideosByCategory","responses","byCategoryMap","forEach","status","categoryId","push","groupVideosByIdAndCategory","result","reduceWatchDetails","find","r","kind","relatedEntry","relatedVideoIds","reduceRelatedVideosRequest","reduceVideoDetails","parsedVideos","filter","getMostPopular","state","getMostPopularVideos","createSelector","videosById","getVideoCategoryIds","getVideosByCategory","videosByCategory","videoIds","videoCategoriesLoaded","videosByCategoryLoaded","getVideoById","getRelatedVideos","getChannelId","getAmountComments","commentCount","allMostPopularVideosLoaded","getMostPopularVideosNextPageToken","InfiniteScroll","children","onEnter","bottomReachedCallback","Loader","active","showLoader","inline","HomeContent","trendingVideos","getTrendingVideos","categoryGrids","getVideoGridsForCategories","mostPopularVideos","categoryTitles","categoryTitle","connect","youtubeLibraryLoaded","bind","libraryLoaded","getYoutubeLibraryLoaded","api","Home","fetchVideosByCategory","categoryIndex","shouldShowLoader","fetchCategoriesAndMostPopularVideos","prevProps","videoCategories","categoryStartIndex","fetchMostPopularVideosByCategory","setState","fetchMostPopularVideos","fetchVideoCategories","dispatch","videoActions","bindActionCreators","HeaderNav","onInputChange","event","query","target","value","onSubmit","escapedSearchQuery","encodeURI","history","header","logo","Form","Field","Input","placeholder","action","onChange","position","ScrollToTop","window","scrollTo","AppLayout","Video","frameBorder","allow","allowFullScreen","Rating","rating","likeCount","dislikeCount","amountLikes","amountDislikes","percentagePositiveRatings","Progress","percent","VideoMetadata","Number","toLocaleString","Button","basic","labelPosition","VideoInfoBox","onToggleCollapseButtonClick","collapsed","channel","iso8601DateString","descriptionParagraphs","getDescriptionParagraphs","getConfig","descriptionTextClass","buttonTitle","publishedAtString","parse","toDateString","buttonText","getSubscriberButtonText","channelThumbnail","circular","color","compact","onClick","videoDescription","split","paragraph","subscriberCount","CommentsHeader","amountComments","Comment","comment","topLevelComment","authorProfileImageUrl","authorDisplayName","textOriginal","AddComment","TextArea","control","autoHeight","Comments","comments","NextUpVideo","Checkbox","toggle","defaultChecked","RelatedVideos","nextUpVideo","relatedVideosPreviews","relatedVideo","channelResponse","channels","channelEntry","getChannel","COMMENT_THREAD","thread","byVideo","reduceCommentThread","res","newComments","item","prevCommentIds","ids","commentIds","byVideoComment","getCommentsForVideo","allComments","commentId","getCommentNextPageToken","WatchContent","relatedVideos","Watch","fetchMoreComments","fetchCommentThread","getVideoId","fetchWatchContent","fetchWatchDetails","watchActions","commentActions","VideoList","videoPreviews","getVideoPreviews","Trending","fetchMoreVideos","fetchTrendingVideos","loaderActive","SEARCH_FOR_VIDEOS","forVideos","searchQuery","reduceSearchForVideos","searchResults","results","concat","getSearchResults","getSearchNextPageToken","Search","searchForVideos","getSearchQuery","youtubeApiLoaded","searchActions","App","component","render","loadYoutubeApi","script","document","createElement","onload","gapi","load","client","setApiKey","process","body","appendChild","isLocalhost","Boolean","hostname","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","error","combineReducers","buildMostPopularVideosRequest","videoCategoryId","fields","buildApiRequest","part","chart","maxResults","regionCode","pageToken","buildVideoDetailRequest","buildChannelRequest","buildCommentThreadRequest","buildSearchRequest","q","buildRelatedVideosRequest","amountRelatedVideos","relatedToVideoId","requestMethod","params","properties","p","removeEmptyParams","resource","normalizedProps","substr","adjustedName","replace","prop","propArray","ref","pa","createResource","watchMostPopularVideos","watchVideoCategories","watchMostPopularVideosByCategory","fetchEntity","requests","wrapper","ignoreErrors","call","all","put","take","fork","takeEvery","fetchVideoDetails","watchWatchDetails","fn","shouldFetchChannelInfo","searchListResponse","relatedVideoId","videoDetailResponse","watchCommentThread","watchSearchForVideos","entity","args","ignoreErrorCallback","store","sagaMiddleware","createSagaMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","reducer","applyMiddleware","run","rootSaga","configureStore","ReactDOM","getElementById","URL","origin","addEventListener","fetch","headers","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.e8b114a4.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/logo.e5520ae2.jpg\";","export const REQUEST = 'REQUEST';\r\nexport const SUCCESS = 'SUCCESS';\r\nexport const FAILURE = 'FAILURE';\r\nexport function createRequestTypes(base) {\r\n  if (!base) {\r\n    throw new Error('cannot create request type with base = \\'\\' or base = null');\r\n  }\r\n  return [REQUEST, SUCCESS, FAILURE].reduce((acc, type) => {\r\n    acc[type] = `${base}_${type}`;\r\n    return acc;\r\n  }, {});\r\n}\r\n\r\nexport function createAction(type, payload = {}) {\r\n  return {\r\n    type,\r\n    ...payload,\r\n  };\r\n}","import {createAction, createRequestTypes, REQUEST, SUCCESS, FAILURE} from './index';\r\n\r\nexport const VIDEO_CATEGORIES = createRequestTypes('VIDEO_CATEGORIES');\r\nexport const categories = {\r\n  request: () => createAction(VIDEO_CATEGORIES[REQUEST]),\r\n  success: (response) => createAction(VIDEO_CATEGORIES[SUCCESS], {response}),\r\n  failure: (response) => createAction(VIDEO_CATEGORIES[FAILURE], {response}),\r\n};\r\n\r\nexport const MOST_POPULAR = createRequestTypes('MOST_POPULAR');\r\nexport const mostPopular = {\r\n  request: (amount, loadDescription, nextPageToken) => createAction(MOST_POPULAR[REQUEST], {amount, loadDescription, nextPageToken}),\r\n  success: (response) => createAction(MOST_POPULAR[SUCCESS], {response}),\r\n  failure: (response) => createAction(MOST_POPULAR[FAILURE], {response}),\r\n};\r\n\r\nexport const MOST_POPULAR_BY_CATEGORY = createRequestTypes('MOST_POPULAR_BY_CATEGORY');\r\nexport const mostPopularByCategory = {\r\n  request: (categories) => createAction(MOST_POPULAR_BY_CATEGORY[REQUEST], {categories}),\r\n  success: (response, categories) => createAction(MOST_POPULAR_BY_CATEGORY[SUCCESS], {response, categories}),\r\n  failure: (response) => createAction(MOST_POPULAR_BY_CATEGORY[FAILURE], response),\r\n};\r\n","import React from 'react';\r\nimport {Icon, Menu} from \"semantic-ui-react\";\r\nimport './SideBarItem.scss';\r\nimport {Link, withRouter} from 'react-router-dom';\r\n\r\nexport class SideBarItem extends React.Component {\r\n  render() {\r\n    // React will ignore custom boolean attributes, therefore we pass a string\r\n    // we use this attribute in our SCSS for styling\r\n    const highlight = this.shouldBeHighlighted() ? 'highlight-item' : null;\r\n    return (\r\n      <Link to={{pathname: this.props.path}}>\r\n        <Menu.Item className={['sidebar-item', highlight].join(' ')}>\r\n          <div className='sidebar-item-alignment-container'>\r\n            <span><Icon size='large' name={this.props.icon}/> </span>\r\n            <span>{this.props.label}</span>\r\n          </div>\r\n        </Menu.Item>\r\n      </Link>\r\n    );\r\n  }\r\n\r\n  shouldBeHighlighted() {\r\n    const {pathname} = this.props.location;\r\n    if (this.props.path === '/') {\r\n      return pathname === this.props.path;\r\n    }\r\n    return pathname.includes(this.props.path);\r\n  }\r\n}\r\n\r\nexport default withRouter(SideBarItem);","import React from 'react';\r\nimport {Menu} from 'semantic-ui-react';\r\nimport './SideBarHeader.scss';\r\n\r\nexport function SideBarHeader(props) {\r\n  const heading = props.title ? props.title.toUpperCase() : '';\r\n  return (\r\n    <Menu.Item>\r\n      <Menu.Header className='side-bar-header'>{heading}</Menu.Header>\r\n    </Menu.Item>\r\n  );\r\n}","import React from 'react';\r\nimport {Icon, Image, Menu} from \"semantic-ui-react\";\r\nimport './Subscription.scss';\r\n\r\nexport function Subscription(props) {\r\n\r\n  let rightElement = null;\r\n  const {broadcasting, amountNewVideos} = props;\r\n  if (broadcasting) {\r\n    rightElement = <Icon name='signal'/>;\r\n  } else if (amountNewVideos) {\r\n    rightElement = <span className='new-videos-count'>{amountNewVideos}</span>;\r\n  }\r\n\r\n  return (\r\n    <Menu.Item>\r\n      <div className='subscription'>\r\n        <div>\r\n          <Image src='https://via.placeholder.com/28x28' avatar/>\r\n          <span>{props.label}</span>\r\n        </div>\r\n        {rightElement}\r\n      </div>\r\n    </Menu.Item>\r\n  );\r\n}","import React from 'react';\r\nimport {Subscription} from \"./Subscription/Subscription\";\r\nimport {Divider} from \"semantic-ui-react\";\r\nimport {SideBarHeader} from '../SideBarHeader/SideBarHeader';\r\n\r\nexport class Subscriptions extends React.Component {\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <SideBarHeader title='Subscriptions'/>\r\n        <Subscription label='MusicChannel' broadcasting/>\r\n        <Subscription label='Coursea' amountNewVideos={10}/>\r\n        <Subscription label='TEDx Talks' amountNewVideos={23}/>\r\n        <Subscription label='Stanford iOS' amountNewVideos={4}/>\r\n        <Subscription label='Udacity' amountNewVideos={114}/>\r\n        <Divider/>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}","import React from 'react';\r\nimport './SideBarFooter.scss'\r\n\r\nexport function SideBarFooter() {\r\n  return (\r\n    <React.Fragment>\r\n      <div className='footer-block'>\r\n        <div>About Press Copyright</div>\r\n        <div>Creators Advertise</div>\r\n        <div>Developers +MyTube</div>\r\n        <div>Legal</div>\r\n      </div>\r\n      <div className='footer-block'>\r\n        <div>Terms Privacy</div>\r\n        <div>Policy & Safety</div>\r\n        <div>Test new features</div>\r\n      </div>\r\n      <div className='footer-block'>\r\n        <div>All prices include VAT</div>\r\n      </div>\r\n      <div className='footer-block'>\r\n        <div>Â© Productioncoder.com - A Youtube clone for educational purposes under fair use.</div>\r\n      </div>\r\n    </React.Fragment>\r\n  );\r\n}","import React from 'react';\r\nimport SideBarItem from './SideBarItem/SideBarItem';\r\nimport {Menu, Divider} from 'semantic-ui-react';\r\nimport './SideBar.scss';\r\nimport {SideBarHeader} from './SideBarHeader/SideBarHeader';\r\nimport {Subscriptions} from './Subscriptions/Subscriptions';\r\nimport {SideBarFooter} from './SideBarFooter/SideBarFooter';\r\n\r\nexport class SideBar extends React.Component {\r\n  render() {\r\n    return (\r\n      <Menu borderless vertical stackable fixed='left' className='side-nav'>\r\n        <SideBarItem path='/' label='Home' icon='home'/>\r\n        <SideBarItem path='/feed/trending' label='Trending' icon='fire'/>\r\n        <SideBarItem label='Followers' icon='spy'/>\r\n        <Divider/>\r\n        <SideBarHeader title='Library'/>\r\n        <SideBarItem label='History' icon='history'/>\r\n        <SideBarItem label='Watch later' icon='clock'/>\r\n        <SideBarItem label='Liked videos' icon='thumbs up'/>\r\n        <Divider/>\r\n        <Subscriptions/>\r\n        <SideBarHeader title='More from Youtube'/>\r\n        <SideBarItem label='Movies and Shows' icon='film'/>\r\n        <Divider/>\r\n        <SideBarItem label='Report history' icon='flag'/>\r\n        <SideBarItem label='Help' icon='help circle'/>\r\n        <SideBarItem label='Send feedback' icon='comment'/>\r\n        <Divider/>\r\n        <SideBarFooter/>\r\n      </Menu>\r\n    );\r\n  }\r\n}","import React from 'react';\r\nimport './VideoGridHeader.scss';\r\n\r\nexport function VideoGridHeader(props) {\r\n  return (\r\n    <div className='video-grid-header'>\r\n      <span className='title'>{props.title}</span>\r\n    </div>\r\n  );\r\n}","const UNITS = ['K', 'M', 'B', 'T'];\r\n\r\n// https://stackoverflow.com/a/28608086/2328833\r\nexport function getShortNumberString(number) {\r\n  const shouldShowDecimalPlace = UNITS.some((element, index) => {\r\n    const lowerBound = Math.pow(1000, index + 1);\r\n    const upperBound = lowerBound + lowerBound * 10;\r\n    return  number > lowerBound && number < upperBound\r\n  });\r\n  const digits = shouldShowDecimalPlace ? 1 : 0;\r\n  for (let i = UNITS.length - 1; i >= 0; i--) {\r\n    const decimal = Math.pow(1000, i + 1);\r\n\r\n    if (number >= decimal) {\r\n      return (number / decimal).toFixed(digits) + UNITS[i];\r\n    }\r\n  }\r\n  return number.toString();\r\n}","const objMap = ['years', 'months','days', 'hours', 'minutes', 'seconds'];\r\nconst numbers = '\\\\d+(?:[\\\\.,]\\\\d{0,3})?';\r\nconst datePattern = `(${numbers}Y)?(${numbers}M)?(${numbers}D)?`;\r\nconst timePattern = `T(${numbers}H)?(${numbers}M)?(${numbers}S)?`;\r\nconst pattern = new RegExp(`P(?:${datePattern}(?:${timePattern})?)`);\r\n\r\nexport function parseISO8601TimePattern(durationString) {\r\n  // https://github.com/tolu/ISO8601-duration/blob/master/src/index.js\r\n  return durationString.match(pattern).slice(1).reduce((prev, next, idx) => {\r\n    prev[objMap[idx]] = parseFloat(next) || 0;\r\n    return prev\r\n  }, {});\r\n}\r\n\r\nexport function getPublishedAtDateString(iso8601DateString) {\r\n  if (!iso8601DateString) {\r\n    return '';\r\n  }\r\n  const date = new Date(Date.parse(iso8601DateString));\r\n  return date.toDateString();\r\n}\r\n\r\nexport function getVideoDurationString(iso8601DurationString) {\r\n  if (!iso8601DurationString || iso8601DurationString === '') {\r\n    return '';\r\n  }\r\n\r\n  // new Date(Date.parse(...)) doesn't work here\r\n  // therefore we are using our regex approach\r\n  let {days, hours, minutes, seconds} = parseISO8601TimePattern(iso8601DurationString);\r\n\r\n  let secondsString = seconds.toString();\r\n  let minutesString = minutes.toString();\r\n  let accumulatedHours = days * 24 + hours;\r\n\r\n  if (seconds < 10) {\r\n    secondsString = seconds.toString().padStart(2, '0');\r\n  }\r\n  if (minutes < 10 && hours !== 0) {\r\n    minutesString = minutesString.toString().padStart(2, '0');\r\n  }\r\n  if (!accumulatedHours) {\r\n    return [minutesString, secondsString].join(':');\r\n  } else {\r\n    return [accumulatedHours, minutesString, secondsString].join(':');\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n","import React from 'react';\r\nimport {Image} from 'semantic-ui-react';\r\nimport './VideoPreview.scss';\r\n\r\nimport TimeAgo from 'javascript-time-ago';\r\nimport en from 'javascript-time-ago/locale/en';\r\nimport {getShortNumberString} from '../../services/number/number-format';\r\nimport {getVideoDurationString} from '../../services/date/date-format';\r\nimport {Link} from 'react-router-dom';\r\n\r\nTimeAgo.locale(en);\r\nconst timeAgo = new TimeAgo('en-US');\r\n\r\nexport class VideoPreview extends React.Component {\r\n  render() {\r\n    const {video} = this.props;\r\n    if (!video) {\r\n      return <div/>;\r\n    }\r\n\r\n    const duration = video.contentDetails ? video.contentDetails.duration : null;\r\n    const videoDuration = getVideoDurationString(duration);\r\n    const viewAndTimeString = VideoPreview.getFormattedViewAndTime(video);\r\n    const horizontal = this.props.horizontal ? 'horizontal' : null;\r\n    const expanded = this.props.expanded ? 'expanded' : null;\r\n    const description = this.props.expanded ? video.snippet.description : null;\r\n\r\n    return (\r\n      <Link to={{pathname: this.props.pathname, search: this.props.search}}>\r\n        <div className={['video-preview', horizontal, expanded].join(' ')}>\r\n          <div className='image-container'>\r\n            <Image src={video.snippet.thumbnails.medium.url}/>\r\n            <div className='time-label'>\r\n              <span>{videoDuration}</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className='video-info'>\r\n            <div className={['semi-bold', 'show-max-two-lines', expanded].join(' ')}>{video.snippet.title}</div>\r\n            <div className='video-preview-metadata-container'>\r\n              <div className='channel-title'>{video.snippet.channelTitle}</div>\r\n              <div className='view-and-time'>{viewAndTimeString}</div>\r\n              <div className='show-max-two-lines'>{description}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </Link>\r\n    );\r\n  }\r\n\r\n  static getFormattedViewAndTime(video) {\r\n    const publicationDate = new Date(video.snippet.publishedAt);\r\n    const viewCount = video.statistics ? video.statistics.viewCount : null;\r\n    if(viewCount) {\r\n      const viewCountShort = getShortNumberString(video.statistics.viewCount);\r\n      return `${viewCountShort} views â¢ ${timeAgo.format(publicationDate)}`;\r\n    }\r\n    return '';\r\n  }\r\n}","import React from 'react';\r\nimport './VideoGrid.scss';\r\nimport {VideoGridHeader} from \"./VideoGridHeader/VideoGridHeader\";\r\nimport {Divider} from \"semantic-ui-react\";\r\nimport {VideoPreview} from '../VideoPreview/VideoPreview';\r\n\r\nexport function VideoGrid(props) {\r\n  if (!props.videos || !props.videos.length) {\r\n    return <div/>;\r\n  }\r\n  const gridItems = props.videos.map(video => {\r\n    return (<VideoPreview video={video}\r\n                          key={video.id}\r\n                          pathname='/watch'\r\n                          search={`?v=${video.id}`}/>\r\n    );\r\n  });\r\n\r\n  const divider = props.hideDivider ? null : <Divider/>;\r\n  return (\r\n    <React.Fragment>\r\n      <VideoGridHeader title={props.title}/>\r\n      <div className='video-grid'>\r\n        {gridItems}\r\n      </div>\r\n      {divider}\r\n    </React.Fragment>\r\n  );\r\n}","import {createAction, createRequestTypes, FAILURE, REQUEST, SUCCESS} from './index';\r\n\r\nexport const WATCH_DETAILS = createRequestTypes('WATCH_DETAILS');\r\nexport const details = {\r\n  request: (videoId, channelId) => createAction(WATCH_DETAILS[REQUEST], {videoId, channelId}),\r\n  success: (response, videoId) => createAction(WATCH_DETAILS[SUCCESS], {response, videoId}),\r\n  failure: (response) => createAction(WATCH_DETAILS[FAILURE], {response}),\r\n};\r\n\r\nexport const VIDEO_DETAILS = createRequestTypes('VIDEO_DETAILS');\r\nexport const videoDetails = {\r\n  request: () => {\r\n    throw Error('not implemented');\r\n  },\r\n  success: (response) => createAction(VIDEO_DETAILS[SUCCESS], {response}),\r\n  failure: (response) => createAction(VIDEO_DETAILS[FAILURE], {response}),\r\n};","export const getSearchParam = (location, name) => {\r\n  if (!location || !location.search) {\r\n    return null;\r\n  }\r\n  const searchParams = new URLSearchParams(location.search);\r\n  return searchParams.get(name);\r\n};","import {MOST_POPULAR, MOST_POPULAR_BY_CATEGORY, VIDEO_CATEGORIES} from '../actions/video';\r\nimport {SUCCESS} from '../actions';\r\nimport {createSelector} from 'reselect';\r\nimport {SEARCH_LIST_RESPONSE, VIDEO_LIST_RESPONSE} from '../api/youtube-api-response-types';\r\nimport {VIDEO_DETAILS, WATCH_DETAILS} from '../actions/watch';\r\nimport {getSearchParam} from '../../services/url';\r\n\r\nexport const initialState = {\r\n  byId: {},\r\n  mostPopular: {},\r\n  categories: {},\r\n  byCategory: {},\r\n  related: {},\r\n};\r\nexport default function videos(state = initialState, action) {\r\n  switch (action.type) {\r\n    case MOST_POPULAR[SUCCESS]:\r\n      return reduceFetchMostPopularVideos(action.response, state);\r\n    case VIDEO_CATEGORIES[SUCCESS]:\r\n      return reduceFetchVideoCategories(action.response, state);\r\n    case MOST_POPULAR_BY_CATEGORY[SUCCESS]:\r\n      return reduceFetchMostPopularVideosByCategory(action.response, action.categories, state);\r\n    case WATCH_DETAILS[SUCCESS]:\r\n      return reduceWatchDetails(action.response, state);\r\n    case VIDEO_DETAILS[SUCCESS]:\r\n      return reduceVideoDetails(action.response, state);\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction reduceFetchMostPopularVideos(response, prevState) {\r\n  const videoMap = response.items.reduce((accumulator, video) => {\r\n    accumulator[video.id] = video;\r\n    return accumulator;\r\n  }, {});\r\n\r\n  let items = Object.keys(videoMap);\r\n  if (response.hasOwnProperty('prevPageToken') && prevState.mostPopular) {\r\n    items = [...prevState.mostPopular.items, ...items];\r\n  }\r\n\r\n  const mostPopular = {\r\n    totalResults: response.pageInfo.totalResults,\r\n    nextPageToken: response.nextPageToken,\r\n    items,\r\n  };\r\n\r\n  return {\r\n    ...prevState,\r\n    mostPopular,\r\n    byId: {...prevState.byId, ...videoMap},\r\n  };\r\n}\r\n\r\nfunction reduceFetchVideoCategories(response, prevState) {\r\n  const categoryMapping = response.items.reduce((accumulator, category) => {\r\n    accumulator[category.id] = category.snippet.title;\r\n    return accumulator;\r\n  }, {});\r\n  return {\r\n    ...prevState,\r\n    categories: categoryMapping,\r\n  };\r\n}\r\n\r\nfunction reduceFetchMostPopularVideosByCategory(responses, categories, prevState) {\r\n  let videoMap = {};\r\n  let byCategoryMap = {};\r\n\r\n  responses.forEach((response, index) => {\r\n    // ignore answer if there was an error\r\n    if (response.status === 400) return;\r\n\r\n    const categoryId = categories[index];\r\n    const {byId, byCategory} = groupVideosByIdAndCategory(response.result);\r\n    videoMap = {...videoMap, ...byId};\r\n    byCategoryMap[categoryId] = byCategory;\r\n  });\r\n\r\n  // compute new state\r\n  return {\r\n    ...prevState,\r\n    byId: {...prevState.byId, ...videoMap},\r\n    byCategory: {...prevState.byCategory, ...byCategoryMap},\r\n  };\r\n}\r\n\r\nfunction groupVideosByIdAndCategory(response) {\r\n  const videos = response.items;\r\n  const byId = {};\r\n  const byCategory = {\r\n    totalResults: response.pageInfo.totalResults,\r\n    nextPageToken: response.nextPageToken,\r\n    items: [],\r\n  };\r\n\r\n  videos.forEach((video) => {\r\n    byId[video.id] = video;\r\n\r\n    const items = byCategory.items;\r\n    if(items && items) {\r\n      items.push(video.id);\r\n    } else {\r\n      byCategory.items = [video.id];\r\n    }\r\n  });\r\n\r\n  return {byId, byCategory};\r\n}\r\n\r\nfunction reduceWatchDetails(responses, prevState) {\r\n  const videoDetailResponse = responses.find(r => r.result.kind === VIDEO_LIST_RESPONSE);\r\n  // we know that items will only have one element\r\n  // because we explicitly asked for a video with a specific id\r\n  const video = videoDetailResponse.result.items[0];\r\n  const relatedEntry = reduceRelatedVideosRequest(responses);\r\n\r\n  return {\r\n    ...prevState,\r\n    byId: {\r\n      ...prevState.byId,\r\n      [video.id]: video\r\n    },\r\n    related: {\r\n      ...prevState.related,\r\n      [video.id]: relatedEntry\r\n    }\r\n  };\r\n}\r\n\r\nfunction reduceRelatedVideosRequest(responses) {\r\n  const relatedVideosResponse = responses.find(r => r.result.kind === SEARCH_LIST_RESPONSE);\r\n  const {pageInfo, items, nextPageToken} = relatedVideosResponse.result;\r\n  const relatedVideoIds = items.map(video => video.id.videoId);\r\n\r\n  return {\r\n    totalResults: pageInfo.totalResults,\r\n    nextPageToken,\r\n    items: relatedVideoIds\r\n  };\r\n}\r\n\r\nfunction reduceVideoDetails(responses, prevState) {\r\n  const videoResponses = responses.filter(response => response.result.kind === VIDEO_LIST_RESPONSE);\r\n  const parsedVideos = videoResponses.reduce((videoMap, response) => {\r\n    // we're explicitly asking for a video with a particular id\r\n    // so the response set must either contain 0 items (if a video with the id does not exist)\r\n    // or at most one item (i.e. the channel we've been asking for)\r\n    const video = response.result.items ? response.result.items[0] : null;\r\n    if (!video) {\r\n      return videoMap;\r\n    }\r\n    videoMap[video.id] = video;\r\n    return videoMap;\r\n  }, {});\r\n\r\n  return {\r\n    ...prevState,\r\n    byId: {...prevState.byId, ...parsedVideos},\r\n  };\r\n}\r\n\r\n/* function reduceVideoDetails(responses) {\r\n  const videoResponses = responses.filter(response => response.result.kind === VIDEO_LIST_RESPONSE);\r\n  return videoResponses.reduce((accumulator, response) => {\r\n    response.result.items.forEach(video => {\r\n      accumulator[video.id] = video;\r\n    });\r\n    return accumulator;\r\n  }, {});\r\n}\r\n\r\nfunction reduceRelatedVideos(responses, videoIds) {\r\n  const videoResponses = responses.filter(response => response.result.kind === SEARCH_LIST_RESPONSE);\r\n  return videoResponses.reduce((accumulator, response, index) => {\r\n    const relatedIds = response.result.items.map(video => video.id.videoId);\r\n    accumulator[videoIds[index]] = {\r\n      totalResults: response.result.pageInfo.totalResults,\r\n      nextPageToken: response.result.nextPageToken,\r\n      items: relatedIds\r\n    };\r\n    return accumulator;\r\n  }, {});\r\n} */\r\n\r\n\r\n/*\r\n*   Selectors\r\n* */\r\nconst getMostPopular = (state) => state.videos.mostPopular;\r\nexport const getMostPopularVideos = createSelector(\r\n  (state) => state.videos.byId,\r\n  getMostPopular,\r\n  (videosById, mostPopular) => {\r\n    if (!mostPopular || !mostPopular.items) {\r\n      return [];\r\n    }\r\n    return mostPopular.items.map(videoId => videosById[videoId]);\r\n  }\r\n);\r\nexport const getVideoCategoryIds = createSelector(\r\n  state => state.videos.categories,\r\n  (categories) => {\r\n    return Object.keys(categories || {});\r\n  }\r\n);\r\n\r\nexport const getVideosByCategory = createSelector(\r\n  state => state.videos.byCategory,\r\n  state => state.videos.byId,\r\n  state => state.videos.categories,\r\n  (videosByCategory, videosById, categories) => {\r\n    return Object.keys(videosByCategory || {}).reduce((accumulator, categoryId) => {\r\n      const videoIds = videosByCategory[categoryId].items;\r\n      const categoryTitle = categories[categoryId];\r\n      accumulator[categoryTitle] = videoIds.map(videoId => videosById[videoId]);\r\n      return accumulator;\r\n    }, {});\r\n  }\r\n);\r\n\r\nexport const videoCategoriesLoaded = createSelector(\r\n  state => state.videos.categories,\r\n  (categories) => {\r\n    return Object.keys(categories || {}).length !== 0;\r\n  }\r\n);\r\n\r\nexport const videosByCategoryLoaded = createSelector(\r\n  state => state.videos.byCategory,\r\n  (videosByCategory) => {\r\n    return Object.keys(videosByCategory || {}).length;\r\n  }\r\n);\r\n\r\nexport const getVideoById = (state, videoId) => {\r\n  return state.videos.byId[videoId];\r\n};\r\nconst getRelatedVideoIds = (state, videoId) => {\r\n  const related = state.videos.related[videoId];\r\n  return related ? related.items : [];\r\n};\r\nexport const getRelatedVideos = createSelector(\r\n  getRelatedVideoIds,\r\n  state => state.videos.byId,\r\n  (relatedVideoIds, videos) => {\r\n    if (relatedVideoIds) {\r\n      // filter kicks out null values we might have\r\n      return relatedVideoIds.map(videoId => videos[videoId]).filter(video => video);\r\n    }\r\n    return [];\r\n  });\r\n\r\nexport const getChannelId = (state, location, name) => {\r\n  const videoId = getSearchParam(location, name);\r\n  const video = state.videos.byId[videoId];\r\n  if (video) {\r\n    return video.snippet.channelId;\r\n  }\r\n  return null;\r\n};\r\n\r\nexport const getAmountComments = createSelector(\r\n  getVideoById,\r\n  (video) => {\r\n    if (video) {\r\n      return video.statistics.commentCount;\r\n    }\r\n    return 0;\r\n  });\r\n\r\nexport const allMostPopularVideosLoaded = createSelector(\r\n  [getMostPopular],\r\n  (mostPopular) => {\r\n    const amountFetchedItems = mostPopular.items ? mostPopular.items.length : 0;\r\n    return amountFetchedItems === mostPopular.totalResults;\r\n  }\r\n);\r\n\r\nexport const getMostPopularVideosNextPageToken = createSelector(\r\n  [getMostPopular],\r\n  (mostPopular) => {\r\n    return mostPopular.nextPageToken;\r\n  }\r\n);\r\n\r\n","export const VIDEO_LIST_RESPONSE = 'youtube#videoListResponse';\r\nexport const CHANNEL_LIST_RESPONSE = 'youtube#channelListResponse';\r\nexport const SEARCH_LIST_RESPONSE = 'youtube#searchListResponse';\r\nexport const COMMENT_THREAD_LIST_RESPONSE = 'youtube#commentThreadListResponse';","import React from 'react';\r\nimport {Waypoint} from 'react-waypoint';\r\nimport {Loader} from 'semantic-ui-react';\r\nimport './InfiniteScroll.scss';\r\n\r\nexport function InfiniteScroll(props) {\r\n  return (\r\n    <React.Fragment>\r\n      {props.children}\r\n      <Waypoint onEnter={props.bottomReachedCallback}>\r\n        <div className='loader-container'>\r\n          <Loader active={props.showLoader} inline='centered' />\r\n        </div>\r\n      </Waypoint>\r\n    </React.Fragment>\r\n  );\r\n}","import {VideoGrid} from '../../../components/VideoGrid/VideoGrid';\r\nimport React from 'react';\r\nimport './HomeContent.scss';\r\nimport {getMostPopularVideos, getVideosByCategory} from '../../../store/reducers/videos';\r\nimport {connect} from 'react-redux';\r\nimport {InfiniteScroll} from '../../../components/InfiniteScroll/InfiniteScroll';\r\n\r\nconst AMOUNT_TRENDING_VIDEOS = 12;\r\n\r\nexport class HomeContent extends React.Component {\r\n  render() {\r\n    const trendingVideos = this.getTrendingVideos();\r\n    const categoryGrids = this.getVideoGridsForCategories();\r\n\r\n    return (\r\n      <div className='home-content'>\r\n        <div className=\"responsive-video-grid-container\">\r\n          <InfiniteScroll bottomReachedCallback={this.props.bottomReachedCallback} showLoader={this.props.showLoader}>\r\n            <VideoGrid title='Trending' videos={trendingVideos}/>\r\n            {categoryGrids}\r\n          </InfiniteScroll>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getTrendingVideos() {\r\n    return this.props.mostPopularVideos.slice(0, AMOUNT_TRENDING_VIDEOS);\r\n  }\r\n\r\n  getVideoGridsForCategories() {\r\n    const categoryTitles = Object.keys(this.props.videosByCategory || {});\r\n    return categoryTitles.map((categoryTitle,index) => {\r\n      const videos = this.props.videosByCategory[categoryTitle];\r\n      // the last video grid element should not have a divider\r\n      const hideDivider = index === categoryTitles.length - 1;\r\n      return <VideoGrid title={categoryTitle} videos={videos} key={categoryTitle} hideDivider={hideDivider}/>;\r\n    });\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    videosByCategory: getVideosByCategory(state),\r\n    mostPopularVideos: getMostPopularVideos(state),\r\n  };\r\n}\r\nexport default connect(mapStateToProps, null)(HomeContent);","import {createAction} from './index';\r\n\r\nexport const YOUTUBE_LIBRARY_LOADED = 'YOUTUBE_LIBRARY_LOADED';\r\nexport const youtubeLibraryLoaded = createAction.bind(null, YOUTUBE_LIBRARY_LOADED);","import {YOUTUBE_LIBRARY_LOADED} from '../actions/api';\r\n\r\nconst initialState = {\r\n  libraryLoaded: false,\r\n};\r\nexport default function (state = initialState, action) {\r\n  switch (action.type) {\r\n    case YOUTUBE_LIBRARY_LOADED:\r\n      return {\r\n        libraryLoaded: true,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n}\r\nexport const getYoutubeLibraryLoaded = (state) => state.api.libraryLoaded;","import React from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport * as videoActions from \"../../store/actions/video\";\r\nimport './Home.scss';\r\nimport {SideBar} from '../SideBar/SideBar';\r\nimport HomeContent from './HomeContent/HomeContent';\r\nimport {bindActionCreators} from 'redux';\r\nimport {getYoutubeLibraryLoaded} from '../../store/reducers/api';\r\nimport {getVideoCategoryIds, videoCategoriesLoaded, videosByCategoryLoaded} from '../../store/reducers/videos';\r\n\r\nclass Home extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      categoryIndex: 0,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <SideBar/>\r\n        <HomeContent\r\n          bottomReachedCallback={this.bottomReachedCallback}\r\n          showLoader={this.shouldShowLoader()}/>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (this.props.youtubeLibraryLoaded) {\r\n      this.fetchCategoriesAndMostPopularVideos();\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.youtubeLibraryLoaded !== prevProps.youtubeLibraryLoaded) {\r\n      this.fetchCategoriesAndMostPopularVideos();\r\n    } else if (this.props.videoCategories !== prevProps.videoCategories) {\r\n      this.fetchVideosByCategory();\r\n    }\r\n  }\r\n\r\n  fetchVideosByCategory() {\r\n    const categoryStartIndex = this.state.categoryIndex;\r\n    const categories = this.props.videoCategories.slice(categoryStartIndex, categoryStartIndex + 3);\r\n    this.props.fetchMostPopularVideosByCategory(categories);\r\n    this.setState(prevState => {\r\n      return {\r\n        categoryIndex: prevState.categoryIndex + 3,\r\n      };\r\n    });\r\n  }\r\n\r\n  fetchCategoriesAndMostPopularVideos() {\r\n    this.props.fetchMostPopularVideos();\r\n    this.props.fetchVideoCategories();\r\n  }\r\n\r\n  bottomReachedCallback = () => {\r\n    if (!this.props.videoCategoriesLoaded) {\r\n      return;\r\n    }\r\n    this.fetchVideosByCategory();\r\n  };\r\n\r\n  shouldShowLoader() {\r\n    if (this.props.videoCategoriesLoaded && this.props.videosByCategoryLoaded) {\r\n      return this.state.categoryIndex < this.props.videoCategories.length;\r\n    }\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    youtubeLibraryLoaded: getYoutubeLibraryLoaded(state),\r\n    videoCategories: getVideoCategoryIds(state),\r\n    videoCategoriesLoaded: videoCategoriesLoaded(state),\r\n    videosByCategoryLoaded: videosByCategoryLoaded(state),\r\n  };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  const fetchMostPopularVideos = videoActions.mostPopular.request;\r\n  const fetchVideoCategories = videoActions.categories.request;\r\n  const fetchMostPopularVideosByCategory = videoActions.mostPopularByCategory.request;\r\n  return bindActionCreators({fetchMostPopularVideos, fetchVideoCategories, fetchMostPopularVideosByCategory}, dispatch);\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Home);","import React from 'react';\r\nimport {Form, Icon, Image, Input, Menu} from 'semantic-ui-react';\r\nimport './HeaderNav.scss';\r\nimport logo from '../../assets/images/logo.jpg';\r\nimport {Link, withRouter} from 'react-router-dom';\r\n\r\nexport class HeaderNav extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      query: '',\r\n    };\r\n  }\r\n  render() {\r\n    return (\r\n      // 1\r\n      <Menu borderless className='top-menu' fixed='top'>\r\n        {/* 2 */}\r\n        <Menu.Item header className='logo'>\r\n          <Link to='/'><Image src={logo} size='tiny'/></Link>\r\n        </Menu.Item>\r\n        {/* 3 */}\r\n        <Menu.Menu className='nav-container'>\r\n          <Menu.Item className='search-input'>\r\n            <Form onSubmit={this.onSubmit}>\r\n              {/* 4 */}\r\n              <Form.Field>\r\n                <Input placeholder='Search'\r\n                       size='small'\r\n                       action='Go'\r\n                       value={this.state.query}\r\n                       onChange={this.onInputChange}\r\n                />\r\n              </Form.Field>\r\n            </Form>\r\n          </Menu.Item>\r\n          {/* 5 */}\r\n          <Menu.Menu position='right'>\r\n            <Menu.Item>\r\n              {/* 6 */}\r\n              <Icon className='header-icon' name='video camera' size='large'/>\r\n            </Menu.Item>\r\n            <Menu.Item>\r\n              <Icon className='header-icon' name='grid layout' size='large'/>\r\n            </Menu.Item>\r\n            <Menu.Item>\r\n              <Icon className='header-icon' name='chat' size='large'/>\r\n            </Menu.Item>\r\n            <Menu.Item>\r\n              <Icon className='header-icon' name='alarm' size='large'/>\r\n            </Menu.Item>\r\n            {/* 7*/}\r\n            <Menu.Item name='avatar'>\r\n              <Image src='https://via.placeholder.com/80x80' avatar/>\r\n            </Menu.Item>\r\n          </Menu.Menu>\r\n        </Menu.Menu>\r\n      </Menu>\r\n    );\r\n  }\r\n  onInputChange = (event) => {\r\n    this.setState({\r\n      query: event.target.value,\r\n    });\r\n  };\r\n\r\n  onSubmit = () => {\r\n    const escapedSearchQuery = encodeURI(this.state.query);\r\n    this.props.history.push(`/results?search_query=${escapedSearchQuery}`);\r\n  };\r\n}\r\n\r\nexport default withRouter(HeaderNav);\r\n","import React from 'react';\r\nimport {withRouter} from 'react-router-dom';\r\n\r\nexport class ScrollToTop extends React.Component {\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.location !== prevProps.location && window) {\r\n      window.scrollTo(0, 0);\r\n    }\r\n  }\r\n  render() {\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport default withRouter(ScrollToTop);","import React from 'react';\r\nimport './AppLayout.scss';\r\nimport HeaderNav from '../../containers/HeaderNav/HeaderNav';\r\nimport ScrollToTop from '../ScrollToTop/ScrollToTop';\r\n\r\nexport function AppLayout(props) {\r\n  return (\r\n    <ScrollToTop>\r\n      <div className='app-layout'>\r\n        <HeaderNav/>\r\n        {props.children}\r\n      </div>\r\n    </ScrollToTop>\r\n  );\r\n}","import React from 'react';\r\nimport './Video.scss';\r\n\r\nconst BASE_EMBED_URL = 'https://www.youtube.com/embed/';\r\n\r\nexport function Video(props) {\r\n  if(!props.id) {\r\n    return null;\r\n  }\r\n  //const embedUrl = `${BASE_EMBED_URL}${props.id}?autoplay=1`;\r\n  return (\r\n    <div className='video-container'>\r\n      <div className=\"video\">\r\n        <iframe className='video-player' src={\"https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1\"} frameBorder='0'\r\n                        allow='autoplay; encrypted-media' allowFullScreen title='video' />\r\n              </div>\r\n        \r\n            </div>\r\n          );\r\n        }\r\n","import React from 'react';\r\nimport './Rating.scss';\r\nimport {Icon, Progress} from \"semantic-ui-react\";\r\nimport {getShortNumberString} from '../../services/number/number-format';\r\n\r\nexport function Rating(props) {\r\n  let rating = null;\r\n  let likeCount = props.likeCount !== 0 ? props.likeCount : null;\r\n  let dislikeCount = null;\r\n\r\n  if(props.likeCount && props.dislikeCount) {\r\n    const amountLikes = parseFloat(props.likeCount);\r\n    const amountDislikes = parseFloat(props.dislikeCount);\r\n    const percentagePositiveRatings = 100.0 * (amountLikes / (amountLikes + amountDislikes));\r\n\r\n    // Now that we have calculated the percentage, we bring the numbers into a better readable format\r\n    likeCount = getShortNumberString(amountLikes);\r\n    dislikeCount = getShortNumberString(amountDislikes);\r\n    rating = <Progress percent={percentagePositiveRatings} size='tiny'/>;\r\n  }\r\n  return (\r\n    <div className='rating'>\r\n      <div >\r\n        <Icon name='thumbs outline up'/>\r\n        <span>{likeCount}</span>\r\n      </div>\r\n      <div >\r\n        <Icon name='thumbs outline down'/>\r\n        <span>{dislikeCount}</span>\r\n      </div>\r\n      {rating}\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\nimport {Button, Divider, Icon} from \"semantic-ui-react\";\r\nimport './VideoMetadata.scss';\r\nimport {Rating} from '../Rating/Rating';\r\n\r\nexport function VideoMetadata(props) {\r\n  if (!props.video || !props.video.statistics) {\r\n    return <div/>;\r\n  }\r\n  const viewCount = Number(props.video.statistics.viewCount).toLocaleString();\r\n\r\n  return (\r\n    <div className='video-metadata'>\r\n      <h3>{props.video.snippet.title}</h3>\r\n      <div className='video-stats'>\r\n        <span>{viewCount} views</span>\r\n        <div className='video-actions' >\r\n          <Rating likeCount={props.video.statistics.likeCount}\r\n                  dislikeCount={props.video.statistics.dislikeCount}/>\r\n          <Button basic icon labelPosition='left'>\r\n            <Icon name='share'/>\r\n            Share\r\n          </Button>\r\n          <Button basic icon>\r\n            <Icon name='add circle' />\r\n          </Button>\r\n          <Button basic icon>\r\n            <Icon name='ellipsis horizontal' />\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      <Divider/>\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\nimport './VideoInfoBox.scss';\r\nimport {Image, Button, Divider} from 'semantic-ui-react';\r\nimport Linkify from 'react-linkify';\r\nimport {getPublishedAtDateString} from '../../services/date/date-format';\r\nimport {getShortNumberString} from '../../services/number/number-format';\r\n\r\nexport class VideoInfoBox extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      collapsed: true,\r\n    };\r\n  }\r\n\r\n  render() {\r\n    if (!this.props.video || !this.props.channel) {\r\n      return <div/>;\r\n    }\r\n\r\n    const descriptionParagraphs = this.getDescriptionParagraphs();\r\n    const {descriptionTextClass, buttonTitle} = this.getConfig();\r\n    const publishedAtString = getPublishedAtDateString(this.props.video.snippet.publishedAt);\r\n\r\n    const {channel} = this.props;\r\n    const buttonText = this.getSubscriberButtonText();\r\n    const channelThumbnail = channel.snippet.thumbnails.medium.url;\r\n    const channelTitle = channel.snippet.title;\r\n\r\n    return (\r\n      <div>\r\n        <div className='video-info-box'>\r\n          <Image className='channel-image' src={channelThumbnail} circular/>\r\n          <div className=\"video-info\">\r\n            <div className='channel-name'>{channelTitle}</div>\r\n            <div className='video-publication-date'>{publishedAtString}</div>\r\n          </div>\r\n          <Button className='subscribe' color='youtube'>{buttonText}</Button>\r\n          <div className=\"video-description\">\r\n            <div className={descriptionTextClass}>\r\n              {descriptionParagraphs}\r\n            </div>\r\n            <Button compact onClick={this.onToggleCollapseButtonClick}>{buttonTitle}</Button>\r\n          </div>\r\n        </div>\r\n        <Divider/>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onToggleCollapseButtonClick = () => {\r\n    this.setState((prevState) => {\r\n      return {\r\n        collapsed: !prevState.collapsed\r\n      };\r\n    });\r\n  };\r\n\r\n  getDescriptionParagraphs() {\r\n    const videoDescription = this.props.video.snippet ? this.props.video.snippet.description : null;\r\n    if (!videoDescription) {\r\n      return null;\r\n    }\r\n    return videoDescription.split('\\n').map((paragraph, index) => <p key={index}><Linkify>{paragraph}</Linkify></p>);\r\n  }\r\n\r\n  getSubscriberButtonText() {\r\n    const {channel} = this.props;\r\n    const parsedSubscriberCount = Number(channel.statistics.subscriberCount);\r\n    const subscriberCount = getShortNumberString(parsedSubscriberCount);\r\n    return `Subscribe ${subscriberCount}`;\r\n  }\r\n\r\n  getConfig() {\r\n    let descriptionTextClass = 'collapsed';\r\n    let buttonTitle = 'Show More';\r\n    if (!this.state.collapsed) {\r\n      descriptionTextClass = 'expanded';\r\n      buttonTitle = 'Show Less';\r\n    }\r\n    return {\r\n      descriptionTextClass,\r\n      buttonTitle\r\n    };\r\n  }\r\n}","import React from 'react';\r\nimport {Button, Icon} from \"semantic-ui-react\";\r\nimport './CommentsHeader.scss';\r\n\r\nexport function CommentsHeader(props) {\r\n  return (\r\n    <div className='comments-header'>\r\n      <h4>{props.amountComments} Comments</h4>\r\n      <Button basic compact icon labelPosition='left'>\r\n        <Icon name='align left' />\r\n        Sort by\r\n      </Button>\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\nimport './Comment.scss';\r\nimport {Button, Image} from \"semantic-ui-react\";\r\nimport {Rating} from '../../../components/Rating/Rating';\r\n\r\nexport function Comment(props) {\r\n  if (!props.comment) {\r\n    return <div/>;\r\n  }\r\n  const topLevelComment = props.comment.snippet.topLevelComment;\r\n  const {authorProfileImageUrl, authorDisplayName, textOriginal} = topLevelComment.snippet;\r\n  const likeCount = topLevelComment.snippet.likeCount;\r\n\r\n  return (\r\n    <div className='comment'>\r\n      <Image className='user-image' src={authorProfileImageUrl} circular />\r\n      <div>\r\n        <div className='user-name'>{authorDisplayName}</div>\r\n        <span>{textOriginal}</span>\r\n        <div className='comment-actions'>\r\n          <Rating likeCount={likeCount}/> <Button size='mini' compact>REPLY</Button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\nimport './AddComment.scss';\r\nimport {Form, Image, TextArea} from \"semantic-ui-react\";\r\n\r\nexport function AddComment() {\r\n  return (\r\n    <div className='add-comment'>\r\n      <Image className='user-image' src='https://via.placeholder.com/48x48' circular/>\r\n      <Form>\r\n        <Form.TextArea control={TextArea} autoHeight placeholder='Add a public comment' />\r\n      </Form>\r\n    </div>\r\n  );\r\n}","import React from 'react';\r\nimport {CommentsHeader} from \"./CommentsHeader/CommentsHeader\";\r\nimport {Comment} from './Comment/Comment';\r\nimport {AddComment} from './AddComment/AddComment';\r\n\r\nexport class Comments extends React.Component {\r\n  render() {\r\n    if (!this.props.comments) {\r\n      return <div/>;\r\n    }\r\n\r\n    const comments = this.props.comments.map((comment) => {\r\n      return <Comment comment={comment} key={comment.id}/>\r\n    });\r\n\r\n    return(\r\n      <div>\r\n        <CommentsHeader amountComments={this.props.amountComments}/>\r\n        <AddComment key='add-comment'/>\r\n        {comments}\r\n      </div>\r\n    );\r\n  }\r\n}","import React from 'react';\r\nimport './NextUpVideo.scss';\r\nimport {Checkbox, Divider} from \"semantic-ui-react\";\r\nimport {VideoPreview} from '../../VideoPreview/VideoPreview';\r\n\r\nexport function NextUpVideo(props) {\r\n  return (\r\n    <React.Fragment>\r\n      <div className='next-up-container'>\r\n        <h4>Up next</h4>\r\n        <div className='up-next-toggle'>\r\n          <span>Autoplay</span>\r\n          <Checkbox toggle defaultChecked/>\r\n        </div>\r\n      </div>\r\n      <VideoPreview horizontal={true} video={props.video} pathname='/watch' search={`?v=${props.video.id}`}/>\r\n      <Divider/>\r\n    </React.Fragment>\r\n  );\r\n}","import React from 'react';\r\nimport {VideoPreview} from '../VideoPreview/VideoPreview';\r\nimport './RelatedVideos.scss';\r\nimport {NextUpVideo} from './NextUpVideo/NextUpVideo';\r\n\r\nexport function RelatedVideos(props) {\r\n  if (!props.videos || !props.videos.length) {\r\n    return <div className='related-videos'/>;\r\n  }\r\n\r\n  // safe because before we check if the array has at least one element\r\n  const nextUpVideo = props.videos[0];\r\n  const remainingVideos = props.videos.slice(1);\r\n\r\n  const relatedVideosPreviews = remainingVideos.map(relatedVideo => (\r\n      <VideoPreview video={relatedVideo}\r\n                    key={relatedVideo.id}\r\n                    pathname='/watch'\r\n                    search={`?v=${relatedVideo.id}`}\r\n                    horizontal={true}/>\r\n  ));\r\n\r\n  return (\r\n    <div className='related-videos'>\r\n      <NextUpVideo video={nextUpVideo}/>\r\n      {relatedVideosPreviews}\r\n    </div>\r\n  );\r\n}","import {VIDEO_DETAILS, WATCH_DETAILS} from '../actions/watch';\r\nimport {SUCCESS} from '../actions';\r\nimport {CHANNEL_LIST_RESPONSE} from '../api/youtube-api-response-types';\r\n\r\nconst initialState = {\r\n  byId: {}\r\n};\r\n\r\nexport default function (state = initialState, action) {\r\n  switch (action.type) {\r\n    case WATCH_DETAILS[SUCCESS]:\r\n      return reduceWatchDetails(action.response, state);\r\n    case VIDEO_DETAILS[SUCCESS]:\r\n      return reduceVideoDetails(action.response, state);\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction reduceWatchDetails(responses, prevState) {\r\n  const channelResponse = responses.find(response => response.result.kind === CHANNEL_LIST_RESPONSE);\r\n  let channels = {};\r\n  if (channelResponse && channelResponse.result.items) {\r\n    // we know that there will only be one item\r\n    // because we ask for a channel with a specific id\r\n    const channel = channelResponse.result.items[0];\r\n    channels[channel.id] = channel;\r\n  }\r\n  return {\r\n    ...prevState,\r\n    byId: {\r\n      ...prevState.byId,\r\n      ...channels\r\n    }\r\n  };\r\n}\r\n\r\nfunction reduceVideoDetails(responses, prevState) {\r\n  const channelResponse = responses.find(response => response.result.kind === CHANNEL_LIST_RESPONSE);\r\n  let channelEntry = {};\r\n  if (channelResponse && channelResponse.result.items) {\r\n    // we're explicitly asking for a channel with a particular id\r\n    // so the response set must either contain 0 items (if a channel with the specified id does not exist)\r\n    // or at most one item (i.e. the channel we've been asking for)\r\n    const channel = channelResponse.result.items[0];\r\n    channelEntry =  {\r\n      [channel.id]: channel,\r\n    }\r\n  }\r\n\r\n  return {\r\n    ...prevState,\r\n    byId: {\r\n      ...prevState.byId,\r\n      ...channelEntry,\r\n    }\r\n  };\r\n}\r\n\r\n/*\r\n*   Selectors\r\n* */\r\nexport const getChannel = (state, channelId) => {\r\n  if (!channelId) return null;\r\n  return state.channels.byId[channelId];\r\n};","import {createAction, createRequestTypes, FAILURE, REQUEST, SUCCESS} from './index';\r\n\r\nexport const COMMENT_THREAD = createRequestTypes('COMMENT_THREAD');\r\nexport const thread = {\r\n  request: (videoId, nextPageToken) => createAction(COMMENT_THREAD[REQUEST], {videoId, nextPageToken}),\r\n  success: (response, videoId) => createAction(COMMENT_THREAD[SUCCESS], {response, videoId}),\r\n  failure: (response) => createAction(COMMENT_THREAD[FAILURE], {response}),\r\n};","import {SUCCESS} from '../actions';\r\nimport {WATCH_DETAILS} from '../actions/watch';\r\nimport {COMMENT_THREAD_LIST_RESPONSE} from '../api/youtube-api-response-types';\r\nimport {createSelector} from 'reselect';\r\nimport {COMMENT_THREAD} from '../actions/comment';\r\nimport {getSearchParam} from '../../services/url';\r\n\r\nconst initialState = {\r\n  byVideo: {},\r\n  byId: {},\r\n};\r\nexport default function (state = initialState, action) {\r\n  switch (action.type) {\r\n    case COMMENT_THREAD[SUCCESS]:\r\n      return reduceCommentThread(action.response, action.videoId, state);\r\n    case WATCH_DETAILS[SUCCESS]:\r\n      return reduceWatchDetails(action.response, action.videoId, state);\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction reduceWatchDetails(responses, videoId, prevState) {\r\n  const commentThreadResponse = responses.find(res => res.result.kind === COMMENT_THREAD_LIST_RESPONSE);\r\n  return reduceCommentThread(commentThreadResponse.result, videoId, prevState);\r\n}\r\n\r\nfunction reduceCommentThread(response, videoId, prevState) {\r\n  if (!response) {\r\n    return prevState;\r\n  }\r\n  const newComments = response.items.reduce((acc, item) => {\r\n    acc[item.id] = item;\r\n    return acc;\r\n  }, {});\r\n\r\n  // if we have already fetched some comments for a particular video\r\n  // we just append the ids for the new comments\r\n  const prevCommentIds = prevState.byVideo[videoId] ? prevState.byVideo[videoId].ids : [];\r\n  const commentIds = [...prevCommentIds, ...Object.keys(newComments)];\r\n\r\n  const byVideoComment = {\r\n    nextPageToken: response.nextPageToken,\r\n    ids: commentIds,\r\n  };\r\n\r\n  return {\r\n    ...prevState,\r\n    byId: {\r\n      ...prevState.byId,\r\n      ...newComments,\r\n    },\r\n    byVideo: {\r\n      ...prevState.byVideo,\r\n      [videoId]: byVideoComment,\r\n    }\r\n  };\r\n}\r\n\r\n/*\r\n* Selectors\r\n */\r\nconst getCommentIdsForVideo = (state, videoId) => {\r\n  const comment = state.comments.byVideo[videoId];\r\n  if (comment) {\r\n    return comment.ids;\r\n  }\r\n  return [];\r\n};\r\nexport const getCommentsForVideo = createSelector(\r\n  getCommentIdsForVideo,\r\n  state => state.comments.byId,\r\n  (commentIds, allComments) => {\r\n    return commentIds.map(commentId => allComments[commentId]);\r\n  }\r\n);\r\n\r\nconst getComment = (state, location) => {\r\n  const videoId = getSearchParam(location, 'v');\r\n  return state.comments.byVideo[videoId];\r\n};\r\nexport const getCommentNextPageToken = createSelector(\r\n  getComment,\r\n  (comment) => {\r\n    return comment ? comment.nextPageToken : null;\r\n  }\r\n);","import React from 'react';\r\nimport {Video} from '../../../components/Video/Video';\r\nimport {VideoMetadata} from '../../../components/VideoMetadata/VideoMetadata';\r\nimport {VideoInfoBox} from '../../../components/VideoInfoBox/VideoInfoBox';\r\nimport {Comments} from '../../Comments/Comments';\r\nimport {RelatedVideos} from '../../../components/RelatedVideos/RelatedVideos';\r\nimport './WatchContent.scss';\r\nimport {getAmountComments, getRelatedVideos, getVideoById} from '../../../store/reducers/videos';\r\nimport {connect} from 'react-redux';\r\nimport {getChannel} from '../../../store/reducers/channels';\r\nimport {getCommentsForVideo} from '../../../store/reducers/comments';\r\nimport {InfiniteScroll} from '../../../components/InfiniteScroll/InfiniteScroll';\r\n\r\nclass WatchContent extends React.Component {\r\n  render() {\r\n    if (!this.props.videoId) {\r\n      return <div/>\r\n    }\r\n    return (\r\n      <InfiniteScroll bottomReachedCallback={this.props.bottomReachedCallback} showLoader={this.shouldShowLoader()}>\r\n        <div className='watch-grid'>\r\n          <Video className='video' id={this.props.videoId}/>\r\n          <VideoMetadata className='metadata' video={this.props.video}/>\r\n          <VideoInfoBox className='video-info-box' video={this.props.video} channel={this.props.channel}/>\r\n          <RelatedVideos className='related-videos' videos={this.props.relatedVideos}/>\r\n          <Comments className='comments' comments={this.props.comments}  amountComments={this.props.amountComments}/>\r\n        </div>\r\n      </InfiniteScroll>\r\n    );\r\n  }\r\n  shouldShowLoader() {\r\n    return !!this.props.nextPageToken;\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state, props) {\r\n  return {\r\n    relatedVideos: getRelatedVideos(state, props.videoId),\r\n    video: getVideoById(state, props.videoId),\r\n    channel: getChannel(state, props.channelId),\r\n    comments: getCommentsForVideo(state, props.videoId),\r\n    amountComments: getAmountComments(state, props.videoId)\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, null)(WatchContent);","import React from 'react';\r\nimport {bindActionCreators} from 'redux';\r\nimport * as watchActions from '../../store/actions/watch';\r\nimport {withRouter} from 'react-router-dom';\r\nimport {connect} from 'react-redux';\r\nimport {getYoutubeLibraryLoaded} from '../../store/reducers/api';\r\nimport WatchContent from './WatchContent/WatchContent';\r\nimport {getSearchParam} from '../../services/url';\r\nimport {getChannelId} from '../../store/reducers/videos';\r\nimport {getCommentNextPageToken} from '../../store/reducers/comments';\r\nimport * as commentActions from '../../store/actions/comment';\r\n\r\n\r\nexport class Watch extends React.Component {\r\n  render() {\r\n    const videoId = this.getVideoId();\r\n    return (\r\n      <WatchContent videoId={videoId} channelId={this.props.channelId} bottomReachedCallback={this.fetchMoreComments}\r\n                    nextPageToken={this.props.nextPageToken}/>\r\n    );\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (this.props.youtubeLibraryLoaded) {\r\n      this.fetchWatchContent();\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.youtubeLibraryLoaded !== prevProps.youtubeLibraryLoaded) {\r\n      this.fetchWatchContent();\r\n    }\r\n  }\r\n\r\n  getVideoId() {\r\n    return getSearchParam(this.props.location, 'v');\r\n  }\r\n\r\n  fetchWatchContent() {\r\n    const videoId = this.getVideoId();\r\n    if (!videoId) {\r\n      this.props.history.push('/');\r\n    }\r\n    this.props.fetchWatchDetails(videoId, this.props.channelId);\r\n  }\r\n\r\n  fetchMoreComments = () => {\r\n    if (this.props.nextPageToken) {\r\n      this.props.fetchCommentThread(this.getVideoId(), this.props.nextPageToken);\r\n    }\r\n  };\r\n}\r\n\r\nfunction mapStateToProps(state, props) {\r\n  return {\r\n    youtubeLibraryLoaded: getYoutubeLibraryLoaded(state),\r\n    channelId: getChannelId(state, props.location, 'v'),\r\n    nextPageToken: getCommentNextPageToken(state, props.location),\r\n  };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  const fetchWatchDetails = watchActions.details.request;\r\n  const fetchCommentThread = commentActions.thread.request;\r\n  return bindActionCreators({fetchWatchDetails, fetchCommentThread}, dispatch);\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Watch));","import React from 'react';\r\nimport {SideBar} from '../../containers/SideBar/SideBar';\r\nimport {InfiniteScroll} from '../InfiniteScroll/InfiniteScroll';\r\nimport './VideoList.scss';\r\nimport {VideoPreview} from '../VideoPreview/VideoPreview';\r\n\r\nexport class VideoList extends React.Component {\r\n  render() {\r\n    const videoPreviews = this.getVideoPreviews();\r\n    return (\r\n      <React.Fragment>\r\n        <SideBar/>\r\n        <div className='video-list'>\r\n          <InfiniteScroll bottomReachedCallback={this.props.bottomReachedCallback} showLoader={this.props.showLoader}>\r\n            {videoPreviews}\r\n          </InfiniteScroll>\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  getVideoPreviews() {\r\n    if(!this.props.videos || !this.props.videos.length) {\r\n      return null;\r\n    }\r\n    const firstVideo = this.props.videos[0];\r\n    if (!firstVideo.snippet.description) {return null}\r\n\r\n    return this.props.videos.map(video => (\r\n      <VideoPreview horizontal={true} expanded={true} video={video} key={video.id} pathname={'/watch'}\r\n                    search={'?v=' + video.id}/>)\r\n    );\r\n  }\r\n\r\n}","import React from 'react';\r\nimport {bindActionCreators} from 'redux';\r\nimport {connect} from 'react-redux';\r\nimport * as videoActions from \"../../store/actions/video\";\r\nimport {\r\n  allMostPopularVideosLoaded,\r\n  getMostPopularVideos,\r\n  getMostPopularVideosNextPageToken\r\n} from '../../store/reducers/videos';\r\nimport {getYoutubeLibraryLoaded} from '../../store/reducers/api';\r\nimport {VideoList} from '../../components/VideoList/VideoList';\r\n\r\nclass Trending extends React.Component {\r\n  componentDidMount() {\r\n    this.fetchTrendingVideos();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.youtubeLibraryLoaded !== this.props.youtubeLibraryLoaded) {\r\n      this.fetchTrendingVideos();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const loaderActive = this.shouldShowLoader();\r\n\r\n    return (<VideoList\r\n      bottomReachedCallback={this.fetchMoreVideos}\r\n      showLoader={loaderActive}\r\n      videos={this.props.videos}/>);\r\n  }\r\n\r\n\r\n  fetchMoreVideos = () => {\r\n    const {nextPageToken} = this.props;\r\n    if (this.props.youtubeLibraryLoaded && nextPageToken) {\r\n      this.props.fetchMostPopularVideos(12, true, nextPageToken);\r\n    }\r\n  };\r\n\r\n  fetchTrendingVideos() {\r\n    if (this.props.youtubeLibraryLoaded) {\r\n      this.props.fetchMostPopularVideos(20, true);\r\n    }\r\n  }\r\n\r\n  shouldShowLoader() {\r\n    return !this.props.allMostPopularVideosLoaded;\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    videos: getMostPopularVideos(state),\r\n    youtubeLibraryLoaded: getYoutubeLibraryLoaded(state),\r\n    allMostPopularVideosLoaded: allMostPopularVideosLoaded(state),\r\n    nextPageToken: getMostPopularVideosNextPageToken(state),\r\n  };\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  const fetchMostPopularVideos = videoActions.mostPopular.request;\r\n  return bindActionCreators({fetchMostPopularVideos}, dispatch);\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Trending);","import {createAction, createRequestTypes, FAILURE, REQUEST, SUCCESS} from './index';\r\n\r\nexport const SEARCH_FOR_VIDEOS = createRequestTypes('SEARCH_FOR_VIDEOS');\r\nexport const forVideos = {\r\n  request: (searchQuery, nextPageToken, amount) => createAction(SEARCH_FOR_VIDEOS[REQUEST], {searchQuery, nextPageToken, amount}),\r\n  success: (response, searchQuery) => createAction(SEARCH_FOR_VIDEOS[SUCCESS], {response, searchQuery}),\r\n  failure: (response, searchQuery) => createAction(SEARCH_FOR_VIDEOS[FAILURE],  {response, searchQuery}),\r\n};","import {SEARCH_FOR_VIDEOS} from '../actions/search';\r\nimport {REQUEST, SUCCESS} from '../actions';\r\n\r\nexport default function (state = {}, action) {\r\n  switch (action.type) {\r\n    case SEARCH_FOR_VIDEOS[SUCCESS]:\r\n      return reduceSearchForVideos(action.response, action.searchQuery, state);\r\n    case SEARCH_FOR_VIDEOS[REQUEST]:\r\n      // delete the previous search because otherwise our component flickers and shows the\r\n      // previous search results before it shows\r\n      return action.nextPageToken ? state : {};\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction reduceSearchForVideos(response, searchQuery, prevState) {\r\n  let searchResults = response.items.map(item => ({...item, id: item.id.videoId}));\r\n  if (prevState.query === searchQuery) {\r\n    const prevResults = prevState.results || [];\r\n    searchResults = prevResults.concat(searchResults);\r\n  }\r\n  return {\r\n    totalResults: response.pageInfo.totalResults,\r\n    nextPageToken: response.nextPageToken,\r\n    query: searchQuery,\r\n    results: searchResults\r\n  };\r\n}\r\n\r\n/*\r\n  Selectors\r\n */\r\nexport const getSearchResults = (state) => state.search.results;\r\nexport const getSearchNextPageToken = (state) => state.search.nextPageToken;\r\n","import React from 'react';\r\nimport './Search.scss';\r\nimport {getYoutubeLibraryLoaded} from '../../store/reducers/api';\r\nimport {getSearchNextPageToken, getSearchResults} from '../../store/reducers/search';\r\nimport * as searchActions from '../../store/actions/search';\r\nimport {bindActionCreators} from 'redux';\r\nimport {connect} from 'react-redux';\r\nimport {getSearchParam} from '../../services/url';\r\nimport {VideoList} from '../../components/VideoList/VideoList';\r\nimport {withRouter} from 'react-router-dom';\r\n\r\nclass Search extends React.Component {\r\n  render() {\r\n    return (<VideoList\r\n      bottomReachedCallback={this.bottomReachedCallback}\r\n      showLoader={true}\r\n      videos={this.props.searchResults}/>);\r\n  }\r\n\r\n  getSearchQuery() {\r\n    return getSearchParam(this.props.location, 'search_query');\r\n  }\r\n\r\n  componentDidMount() {\r\n    if (!this.getSearchQuery()) {\r\n      // redirect to home component if search query is not there\r\n      this.props.history.push('/');\r\n    }\r\n    this.searchForVideos();\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (prevProps.youtubeApiLoaded !== this.props.youtubeApiLoaded) {\r\n      this.searchForVideos();\r\n    }\r\n  }\r\n\r\n  searchForVideos() {\r\n    const searchQuery = this.getSearchQuery();\r\n    if (this.props.youtubeApiLoaded) {\r\n      this.props.searchForVideos(searchQuery);\r\n    }\r\n  }\r\n\r\n  bottomReachedCallback = () => {\r\n    if(this.props.nextPageToken) {\r\n      this.props.searchForVideos(this.getSearchQuery(), this.props.nextPageToken, 25);\r\n    }\r\n  };\r\n\r\n\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  const searchForVideos = searchActions.forVideos.request;\r\n  return bindActionCreators({searchForVideos}, dispatch);\r\n}\r\n\r\nfunction mapStateToProps(state, props) {\r\n  return {\r\n    youtubeApiLoaded: getYoutubeLibraryLoaded(state),\r\n    searchResults: getSearchResults(state, props.location.search),\r\n    nextPageToken: getSearchNextPageToken(state, props.location.search),\r\n  };\r\n}\r\n\r\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Search));\r\n\r\n","import React, {Component} from 'react';\r\nimport Home from './containers/Home/Home';\r\nimport {AppLayout} from './components/AppLayout/AppLayout';\r\nimport {Route, Switch, withRouter} from 'react-router-dom';\r\nimport Watch from './containers/Watch/Watch';\r\nimport {bindActionCreators} from 'redux';\r\nimport {connect} from 'react-redux';\r\nimport {youtubeLibraryLoaded} from './store/actions/api';\r\nimport Trending from './containers/Trending/Trending';\r\nimport Search from './containers/Search/Search';\r\n\r\nconst API_KEY = process.env.REACT_APP_YT_API_KEY;\r\n\r\nclass App extends Component {\r\n  render() {\r\n    return (\r\n      <AppLayout>\r\n        <Switch>\r\n          <Route path=\"/feed/trending\" component={Trending}/>\r\n          <Route path=\"/results\" render={() => <Search key={this.props.location.key}/>}/>\r\n          <Route path=\"/watch\" render={() => <Watch key={this.props.location.key}/>}/>\r\n          <Route path=\"/\" component={Home}/>\r\n        </Switch>\r\n      </AppLayout>\r\n    );\r\n  }\r\n  componentDidMount() {\r\n    this.loadYoutubeApi();\r\n  }\r\n\r\n  loadYoutubeApi() {\r\n    const script = document.createElement(\"script\");\r\n    script.src = \"https://apis.google.com/js/client.js\";\r\n\r\n    script.onload = () => {\r\n      window.gapi.load('client', () => {\r\n        window.gapi.client.setApiKey(API_KEY);\r\n        window.gapi.client.load('youtube', 'v3', () => {\r\n          this.props.youtubeLibraryLoaded();\r\n        });\r\n      });\r\n    };\r\n\r\n    document.body.appendChild(script);\r\n  }\r\n}\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  return bindActionCreators({youtubeLibraryLoaded}, dispatch);\r\n}\r\n\r\nexport default withRouter(connect(null, mapDispatchToProps)(App));","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport default function register() {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Lets check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import apiReducer from './api';\r\nimport {combineReducers} from 'redux';\r\nimport videosReducer from './videos'\r\nimport channelsReducer from './channels';\r\nimport commentsReducer from './comments';\r\nimport searchReducer from './search';\r\n\r\nexport default combineReducers({\r\n  api: apiReducer,\r\n  videos: videosReducer,\r\n  channels: channelsReducer,\r\n  comments: commentsReducer,\r\n  search: searchReducer\r\n});","export function buildVideoCategoriesRequest() {\r\n  return buildApiRequest('GET',\r\n    '/youtube/v3/videoCategories',\r\n    {\r\n      'part': 'snippet',\r\n      'regionCode': 'US'\r\n    }, null);\r\n}\r\n\r\nexport function buildMostPopularVideosRequest(amount = 12, loadDescription = false, nextPageToken, videoCategoryId = null) {\r\n  let fields = 'nextPageToken,prevPageToken,items(contentDetails/duration,id,snippet(channelId,channelTitle,publishedAt,thumbnails/medium,title),statistics/viewCount),pageInfo(totalResults)';\r\n  if (loadDescription) {\r\n    fields += ',items/snippet/description';\r\n  }\r\n  return buildApiRequest('GET',\r\n    '/youtube/v3/videos',\r\n    {\r\n      part: 'snippet,statistics,contentDetails',\r\n      chart: 'mostPopular',\r\n      maxResults: amount,\r\n      regionCode: 'US',\r\n      pageToken: nextPageToken,\r\n      fields,\r\n      videoCategoryId,\r\n    }, null);\r\n}\r\n\r\nexport function buildVideoDetailRequest(videoId) {\r\n  return buildApiRequest('GET',\r\n    '/youtube/v3/videos',\r\n    {\r\n      part: 'snippet,statistics,contentDetails',\r\n      id: videoId,\r\n      fields: 'kind,items(contentDetails/duration,id,snippet(channelId,channelTitle,description,publishedAt,thumbnails/medium,title),statistics)'\r\n    }, null);\r\n}\r\n\r\nexport function buildChannelRequest(channelId) {\r\n  return buildApiRequest('GET',\r\n    '/youtube/v3/channels',\r\n    {\r\n      part: 'snippet,statistics',\r\n      id: channelId,\r\n      fields: 'kind,items(id,snippet(description,thumbnails/medium,title),statistics/subscriberCount)'\r\n    }, null);\r\n}\r\n\r\nexport function buildCommentThreadRequest(videoId, nextPageToken) {\r\n  return buildApiRequest('GET',\r\n    '/youtube/v3/commentThreads',\r\n    {\r\n      part: 'id,snippet',\r\n      pageToken: nextPageToken,\r\n      videoId,\r\n    }, null);\r\n}\r\n\r\nexport function buildSearchRequest(query, nextPageToken, amount = 12) {\r\n  return buildApiRequest('GET',\r\n    '/youtube/v3/search',\r\n    {\r\n      part: 'id,snippet',\r\n      q: query,\r\n      type: 'video',\r\n      pageToken: nextPageToken,\r\n      maxResults: amount,\r\n    }, null);\r\n}\r\n\r\nexport function buildRelatedVideosRequest(videoId, amountRelatedVideos = 12) {\r\n  return buildApiRequest('GET',\r\n    '/youtube/v3/search',\r\n    {\r\n      part: 'snippet',\r\n      type: 'video',\r\n      maxResults: amountRelatedVideos,\r\n      relatedToVideoId: videoId,\r\n    }, null);\r\n}\r\n\r\n/*\r\n  Util - Youtube API boilerplate code\r\n */\r\nexport function buildApiRequest(requestMethod, path, params, properties) {\r\n  params = removeEmptyParams(params);\r\n  let request;\r\n  if (properties) {\r\n    let resource = createResource(properties);\r\n    request = window.gapi.client.request({\r\n      'body': resource,\r\n      'method': requestMethod,\r\n      'path': path,\r\n      'params': params\r\n    });\r\n  } else {\r\n    request = window.gapi.client.request({\r\n      'method': requestMethod,\r\n      'path': path,\r\n      'params': params\r\n    });\r\n  }\r\n  return request;\r\n}\r\n\r\nfunction removeEmptyParams(params) {\r\n  for (var p in params) {\r\n    if (!params[p] || params[p] === 'undefined') {\r\n      delete params[p];\r\n    }\r\n  }\r\n  return params;\r\n}\r\n\r\nfunction createResource(properties) {\r\n  var resource = {};\r\n  var normalizedProps = properties;\r\n  for (var p in properties) {\r\n    var value = properties[p];\r\n    if (p && p.substr(-2, 2) === '[]') {\r\n      var adjustedName = p.replace('[]', '');\r\n      if (value) {\r\n        normalizedProps[adjustedName] = value.split(',');\r\n      }\r\n      delete normalizedProps[p];\r\n    }\r\n  }\r\n  for (var prop in normalizedProps) {\r\n    // Leave properties that don't have values out of inserted resource.\r\n    if (normalizedProps.hasOwnProperty(prop) && normalizedProps[prop]) {\r\n      var propArray = prop.split('.');\r\n      var ref = resource;\r\n      for (var pa = 0; pa < propArray.length; pa++) {\r\n        var key = propArray[pa];\r\n        if (pa === propArray.length - 1) {\r\n          ref[key] = normalizedProps[prop];\r\n        } else {\r\n          ref = ref[key] = ref[key] || {};\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return resource;\r\n}","import {fork, take, takeEvery, call, all, put} from 'redux-saga/effects';\r\nimport * as api from '../api/youtube-api';\r\nimport * as videoActions from '../actions/video';\r\nimport {REQUEST} from '../actions';\r\nimport {fetchEntity, ignoreErrors} from './index';\r\n\r\nexport const fetchVideoCategories = fetchEntity.bind(null, api.buildVideoCategoriesRequest, videoActions.categories);\r\n\r\n\r\nexport function* fetchMostPopularVideosByCategory(categories) {\r\n  const requests = categories.map(categoryId => {\r\n    const wrapper = ignoreErrors(api.buildMostPopularVideosRequest, 12, false, null, categoryId);\r\n    return call(wrapper);\r\n  });\r\n  try {\r\n    const response = yield all(requests);\r\n    yield put(videoActions.mostPopularByCategory.success(response, categories));\r\n  } catch (error) {\r\n    yield put(videoActions.mostPopularByCategory.failure(error));\r\n  }\r\n}\r\n\r\nexport function* fetchMostPopularVideos(amount, loadDescription, nextPageToken) {\r\n  const request = api.buildMostPopularVideosRequest.bind(null, amount, loadDescription, nextPageToken);\r\n  yield fetchEntity(request, videoActions.mostPopular);\r\n}\r\n\r\n\r\n/******************************************************************************/\r\n/******************************* WATCHERS *************************************/\r\n/******************************************************************************/\r\nexport function* watchMostPopularVideos() {\r\n  while (true) {\r\n    const {amount, loadDescription, nextPageToken} = yield take(videoActions.MOST_POPULAR[REQUEST]);\r\n    yield fork(fetchMostPopularVideos, amount, loadDescription, nextPageToken);\r\n  }\r\n}\r\n\r\nexport function* watchVideoCategories() {\r\n  yield takeEvery(videoActions.VIDEO_CATEGORIES[REQUEST], fetchVideoCategories);\r\n}\r\nexport function* watchMostPopularVideosByCategory() {\r\n  while(true) {\r\n    const {categories} = yield take(videoActions.MOST_POPULAR_BY_CATEGORY[REQUEST]);\r\n    yield fork(fetchMostPopularVideosByCategory, categories);\r\n  }\r\n}","import {fork, take, all, put, call} from 'redux-saga/effects';\r\nimport * as watchActions from '../actions/watch';\r\nimport {\r\n  buildVideoDetailRequest,\r\n  buildRelatedVideosRequest,\r\n  buildChannelRequest,\r\n  buildCommentThreadRequest\r\n} from '../api/youtube-api';\r\nimport {REQUEST} from '../actions';\r\nimport {SEARCH_LIST_RESPONSE, VIDEO_LIST_RESPONSE} from '../api/youtube-api-response-types';\r\n\r\nexport function* fetchWatchDetails(videoId, channelId) {\r\n  let requests = [\r\n    buildVideoDetailRequest.bind(null, videoId),\r\n    buildRelatedVideosRequest.bind(null, videoId),\r\n    buildCommentThreadRequest.bind(null, videoId)\r\n  ];\r\n\r\n  if (channelId) {\r\n    requests.push(buildChannelRequest.bind(null, channelId));\r\n  }\r\n\r\n  try {\r\n    const responses = yield all(requests.map(fn => call(fn)));\r\n    yield put(watchActions.details.success(responses, videoId));\r\n    yield call (fetchVideoDetails, responses, channelId === null);\r\n  } catch (error) {\r\n    yield put(watchActions.details.failure(error));\r\n  }\r\n}\r\n\r\nfunction* fetchVideoDetails(responses, shouldFetchChannelInfo) {\r\n  const searchListResponse = responses.find(response => response.result.kind === SEARCH_LIST_RESPONSE);\r\n  const relatedVideoIds =  searchListResponse.result.items.map(relatedVideo => relatedVideo.id.videoId);\r\n\r\n  const requests = relatedVideoIds.map(relatedVideoId => {\r\n    return buildVideoDetailRequest.bind(null, relatedVideoId);\r\n  });\r\n\r\n  if (shouldFetchChannelInfo) {\r\n    // we have to extract the video's channel id from the video details response\r\n    // so we can load additional channel information.\r\n    // this is only needed, when a user directly accesses .../watch?v=1234\r\n    // because then we only know the video id\r\n    const videoDetailResponse = responses.find(response => response.result.kind === VIDEO_LIST_RESPONSE);\r\n    const videos = videoDetailResponse.result.items;\r\n    if (videos && videos.length) {\r\n      requests.push(buildChannelRequest.bind(null, videos[0].snippet.channelId));\r\n    }\r\n  }\r\n\r\n  try {\r\n    const responses = yield all(requests.map(fn => call(fn)));\r\n    yield put(watchActions.videoDetails.success(responses));\r\n  } catch (error) {\r\n    yield put(watchActions.videoDetails.failure(error));\r\n  }\r\n}\r\n\r\n\r\n/******************************************************************************/\r\n/******************************* WATCHERS *************************************/\r\n/******************************************************************************/\r\nexport function* watchWatchDetails() {\r\n  while (true) {\r\n    const {videoId, channelId} = yield take(watchActions.WATCH_DETAILS[REQUEST]);\r\n    yield fork(fetchWatchDetails, videoId, channelId);\r\n  }\r\n}","import {fork, take} from 'redux-saga/effects';\r\nimport {REQUEST} from '../actions';\r\nimport * as commentActions from '../actions/comment'\r\nimport * as api from '../api/youtube-api';\r\nimport {fetchEntity} from './index';\r\n\r\nexport function* fetchCommentThread(videoId, nextPageToken) {\r\n  const request = api.buildCommentThreadRequest.bind(null, videoId, nextPageToken);\r\n  yield fetchEntity(request, commentActions.thread, videoId);\r\n}\r\n\r\n/******************************************************************************/\r\n/******************************* WATCHERS *************************************/\r\n/******************************************************************************/\r\nexport function* watchCommentThread() {\r\n  while(true) {\r\n    const {videoId, nextPageToken} = yield take(commentActions.COMMENT_THREAD[REQUEST]);\r\n    yield fork(fetchCommentThread, videoId, nextPageToken);\r\n  }\r\n}","import * as searchActions from '../actions/search';\r\nimport {REQUEST} from '../actions';\r\nimport {fork, take} from 'redux-saga/effects';\r\nimport * as api from '../api/youtube-api';\r\nimport {fetchEntity} from './index';\r\n\r\nexport function* searchForVideos(searchQuery, nextPageToken, amount) {\r\n  const request = api.buildSearchRequest.bind(null, searchQuery, nextPageToken, amount);\r\n  yield fetchEntity(request, searchActions.forVideos, searchQuery);\r\n}\r\n\r\n/******************************************************************************/\r\n/******************************* WATCHERS *************************************/\r\n/******************************************************************************/\r\nexport function* watchSearchForVideos() {\r\n  while (true) {\r\n    const {searchQuery, amount, nextPageToken} = yield take(searchActions.SEARCH_FOR_VIDEOS[REQUEST]);\r\n    yield fork(searchForVideos, searchQuery, nextPageToken, amount);\r\n  }\r\n}","import {all, call, put, fork} from 'redux-saga/effects';\r\nimport {watchMostPopularVideos, watchMostPopularVideosByCategory, watchVideoCategories} from './video';\r\nimport {watchWatchDetails} from './watch';\r\nimport {watchCommentThread} from './comment';\r\nimport {watchSearchForVideos} from './search';\r\nexport default function* () {\r\n  yield all([\r\n    fork(watchMostPopularVideos),\r\n    fork(watchVideoCategories),\r\n    fork(watchMostPopularVideosByCategory),\r\n    fork(watchWatchDetails),\r\n    fork(watchCommentThread),\r\n    fork(watchSearchForVideos)\r\n  ]);\r\n}\r\n\r\n/*\r\n* entity must have a success, request and failure method\r\n* request is a function that returns a promise when called\r\n* */\r\nexport function* fetchEntity(request, entity, ...args) {\r\n  try {\r\n    const response = yield call(request);\r\n    // we directly return the result object and throw away the headers and the status text here\r\n    // if status and headers are needed, then instead of returning response.result, we have to return just response.\r\n    yield put(entity.success(response.result, ...args));\r\n  } catch (error) {\r\n    yield put(entity.failure(error, ...args));\r\n  }\r\n}\r\n\r\nexport function ignoreErrors(fn, ...args) {\r\n  return () => {\r\n    const ignoreErrorCallback = (response) => response;\r\n    return fn(...args).then(ignoreErrorCallback, ignoreErrorCallback);\r\n  };\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\nimport registerServiceWorker from './registerServiceWorker';\r\nimport 'semantic-ui-css/semantic.min.css';\r\nimport { Provider } from 'react-redux';\r\nimport {BrowserRouter} from 'react-router-dom';\r\nimport {configureStore} from './store/configureStore';\r\n\r\nconst store = configureStore();\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <BrowserRouter>\r\n      <App/>\r\n    </BrowserRouter>\r\n  </Provider>, document.getElementById('root'));\r\nregisterServiceWorker();","import {applyMiddleware, compose, createStore} from 'redux';\r\nimport reducer from './reducers';\r\nimport createSagaMiddleware from 'redux-saga';\r\nimport rootSaga from './sagas';\r\n\r\nexport function configureStore() {\r\n  const sagaMiddleware = createSagaMiddleware();\r\n  const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n  const store = createStore(reducer, composeEnhancers(\r\n    applyMiddleware(sagaMiddleware)\r\n  ));\r\n  sagaMiddleware.run(rootSaga);\r\n  return store;\r\n}"],"sourceRoot":""}